## Предсказание оттока клиентов

### Данные

В *contract.csv* представлена информация о договоре:

- customerID - уникальный ID клиента
- BeginDate - дата заключения договора
- EndDate - дата расторжения договора
- Type - Тип оплаты за услуги (ежемесячный платёж или раз в год, несколько лет)
- PaperlessBilling - Получает ли клиент электронный чек
- PaymentMethod - способы оплаты за услуги
- MonthlyCharges - ежемесячные платежи независимо от типа оплаты
- TotalCharges - Общая сумма платежа клиента

В *personal.csv* представлена информация о клиентах:

- customerID - уникальный ID клиента
- BeginDate - дата заключения договора
- EndDate - дата расторжения договора
- Type - Тип оплаты за услуги (ежемесячный платёж или раз в год, несколько лет)
- PaperlessBilling - Получает ли клиент электронный чек
- PaymentMethod - способы оплаты за услуги
- MonthlyCharges - ежемесячные платежи независимо от типа оплаты
- TotalCharges - Общая сумма платежа клиента

В *Internet.csv* представлена информация об интернет услугах:

- customerID - уникальный ID клиента
- InternetService - варианты подключения интернет-соединения
- OnlineSecurity - Услуга блокировки небезопасных сайтов
- OnlineBackup - Услуга Облачного хранилища файлов
- DeviceProtection - Наличие услуги антивируса
- TechSupport - Услуга Выделенной линии технической поддержки
- StreamingTV - Услуга стримингового телевидения
- StreamingMovies - Услуга каталога фильмов

В *phone.csv* представлена информация об услугах телефонии:

- customerID - уникальный ID клиента
- MultipleLines - Мультиканальная линия или нет (в данном случае отдельно услуга телефона связи или вместе с интернетом)

### Описание проекта

Компания предоставляет услуги связи и интернет. Далее по тексту оператор связи. По статистическим данным нужно построить модель предсказания оттока клиентов

### Навыки и инструменты

Matplotlib, Numpy, Pandas, Seaborn, Catboost, Sklearn

### Результат

В процессе работы над решением задачи были изучены и обработаны на предмет дубликатов, пропусков, преобразованы в нужный формат столбцы, выделен целевой признак, добавлены необходимые для анализа признаки и удалены ненужные столбцы.

Далее был проведен анализ данных. А именно таблицы были объеденены в единый датасет, было рассмотрено распределение целевого признака, выделены расторгнувшие договор клиенты, определены услуги, которыми они пользовались и их стоимость.

После были проведены работы по обучению модели. Здесь пришлось немного отойти от изначального плана действий и была рассмотрена корреляция численных показателей, таких как ежемесячные платежи независимо от типа оплаты, продолжительность действия контракта, общая сумма платежа клиента и факт наличия контракта с оператором связи. Далее были выделены признаки и целевой признак, датасет был разделен на обучающую и тренировочную выборки. После выделения выборок были подобраны гиперпараметры для модели CatBoostClassifier с использованием GridSearchCV, была обучена модель, указав в параметрах scoring='roc_auc' мы получили результат данной метрики. На данном этапе мы столкнулись с трудностями в том, что CatBoostClassifier может обрабатывать как категориальные так и численные признаки, а для RandomForestClassifier нам пришлось кодировать признаки с использованием функции get_dummies. Далее были подобраны гиперпараметры и была обучена модель RandomForestClassifier. По полученным результатам мы поняли, что модель CatBoostClassifier лучше справилась с поставленной задачей. Мы также сделали вывод, что CatBoostClassifier не прихотлива к входящим данным и может обрабатывать как категориальные, так и численные признаки, обучается и предсказывает модель быстрее своих конкурентов. Мы проверили ее на тестовой выборке. Результат на тестовой выборке получился 0.92, что очень хорошо. Далее построили Roc-кривую, чтобы убедиться, что результат не случайный.

Подводя итоги работы был написан краткий вывод о проделанной работе
